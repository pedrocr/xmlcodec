<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>xmlcodec a XML importer/exporter framework for Ruby</title>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

<h1>xmlcodec - a XML importer/exporter framework for Ruby</h1>

<div id="content">

<h2>What is this?</h2>

<p>This is a framework to create importers/exporters of XML formats for Ruby. To create a new importer/exporter all you have to do is create a ruby class for each of the XML elements.</p>

<h2>Where do I get it?</h2>

This project is hosted on RubyForge. You can see the <a href="http://rubyforge.org/projects/xmlcodec/">project page</a> or go straight to the <a href="http://rubyforge.org/frs/?group_id=1681">files section</a> to get the latest version. If you have <a href="http://docs.rubygems.org/">RubyGems</a> installed you can just do <i>"gem install xmlcodec"</i> and it will fetch the latest version from the network.

<h2>What features does it have?</h2>

<p>The basic model of the framework is that an importer/exporter maps a XML tree into a Ruby object tree. To do this you write Ruby classes for each of the XML format's elements. After that you get several API's for free:</p>

<ul>
  <li>Import/Export XML text</li>
  <li>Import/Export <a href="http://www.germane-software.com/software/rexml/">REXML</a> DOM</li>
  <li>A stream parser whose events are whole elements imported into a Ruby object</li>
  <li>A partial export API that can be used to create huge XML files with constant memory usage</li> 
</ul>

<p>The first two API's treat the XML as a whole tree at once.</p>
<p>The stream parser allows you to parse a very big XML file as a stream but with more meaningfull events than a regular XML stream parser.</p>
<p>The partial export API allows you to create huge XML files the same way you'd create a small one (by putting elements in the Ruby tree) but without having to create the whole tree in memory. This is done by exporting an element into the output file and then removing it from the tree. This is not done automatically, but it's pretty easy to do.</p>

<h2>How do I use it?</h2>

Look at the <a href="doc/">API docs</a> for examples and full API of everything. 

<h2>Some Examples Then?</h2>

Suppose you have this XML format:

<pre>
  &lt;root&gt;
    &lt;firstelement&gt;
      &lt;secondelement firstattr='1'&gt;bar&lt;/secondelement&gt;
      &lt;secondelement firstattr='2'&gt;foo&lt;/secondelement&gt;
    &lt;/firstelement&gt;
  &lt;/root&gt;
</pre>

To create an importer/exporter for it you'd write:

<pre>
  require 'xmlcodec'

  class Root &lt; XMLCodec::XMLElement
    elname 'root'
    xmlsubel :firstelement
  end

  class FirstElement &lt; XMLCodec::XMLElement
    elname 'firstelement'
    xmlsubel_mult :secondelement
  end

  class SecondElement &lt; XMLCodec::XMLElement
    elname 'secondelement'
    elwithvalue
    xmlattr :firstattr
  end
</pre>

And that's it for the code you have to write. To import some xml you'd do:

<pre>
  # From text
  Root.import_xml_text(File.new('file.xml'))
  
  # From a REXML DOM
  Root.import_xml(REXML::Document.new(File.new('file.xml')))
</pre>

To generate some XML you can do:

<pre>
  # To generate XML text
  string = some_element.xml_text

  # To generate REXML DOM
  doc = some_element.create_xml(REXML::Document.new)
</pre>
  
Using the stream parser is also very easy:

<pre>
  class MyStreamListener
    def el_secondelement(el)
      obj = el.get_object
    
      ... do something with obj ...
    
      # To remove it from the stream so the parent 
      # doesn't include it and memory is freed.
      el.consume
    end
  end
  
  parser = XMLStreamObjectParser.new(MyStreamListener.new)
  parser.parse(some_string_or_file)
</pre>

The partial exporter is also pretty easy to use:

<pre>
  file = File.new('somefile.xml')
  fe = FirstElement.new
  10000.times do |i|
    se = SecondElement.new(i)
    fe.secondelement << se
    se.partial_export(file)
  end
  fe.end_partial_export(file)
</pre>

</div>
<div id="footer">
<span>
This page validates as <a href="http://validator.w3.org/check/referer">HTML 4.01 Strict</a> and <a href="http://jigsaw.w3.org/css-validator/check/referer">CSS 2.1</a>
</span>
</div>
</body>
</html>
